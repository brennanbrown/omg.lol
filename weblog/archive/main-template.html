<!-- Dark/light mode toggle enabled -->
<!DOCTYPE html>
<html lang="en">
<head>
<title>{weblog-title}{separator}{post-title}</title>
 <meta charset="utf-8">
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <meta name="description" content="{weblog-description}">
 <link rel="preconnect" href="https://fonts.googleapis.com">
 <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
 <link rel="preconnect" href="https://cdnjs.cloudflare.com">
 <link rel="preconnect" href="https://brennan.paste.lol">
 <link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,400;1,700&family=Public+Sans:ital,wght@0,400;0,700;0,800;1,400;1,700&family=JetBrains+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" media="print" onload="this.media='all'">
 <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"></noscript>
 <link rel="stylesheet" href="https://brennan.paste.lol/stylesheet.css/raw">
 {feeds}
 <script>
   // Apply saved theme immediately to avoid flash
  (function() {
    const html = document.documentElement;
    const savedTheme = localStorage.getItem('theme');
    const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const currentTheme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
    
    if (currentTheme === 'dark') {
      html.classList.add('dark-mode');
      html.classList.remove('light-mode');
    } else {
      html.classList.add('light-mode');
      html.classList.remove('dark-mode');
    }
  })();
   
   document.addEventListener('DOMContentLoaded', function() {
    console.log('DOMContentLoaded fired');
    
    // Theme toggle functionality
    const toggleButton = document.getElementById('theme-toggle');
    console.log('Toggle button found:', toggleButton);
    
    if (toggleButton) {
      const icon = toggleButton.querySelector('i');
      const html = document.documentElement;
      const savedTheme = localStorage.getItem('theme');
      const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const currentTheme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
      
      console.log('Current theme:', currentTheme);
      console.log('HTML classes before setup:', html.className);
      
      // Set initial icon based on current theme
      if (html.classList.contains('dark-mode') || currentTheme === 'dark') {
        icon.classList.remove('fa-moon');
        icon.classList.add('fa-sun');
      }
      
      // Toggle theme on button click
      toggleButton.addEventListener('click', function(e) {
        console.log('Toggle button clicked!');
        e.preventDefault();
        
        const isDark = html.classList.contains('light-mode');
        console.log('Switching to dark mode:', isDark);
        
        if (isDark) {
          html.classList.add('dark-mode');
          html.classList.remove('light-mode');
          localStorage.setItem('theme', 'dark');
          icon.classList.remove('fa-moon');
          icon.classList.add('fa-sun');
        } else {
          html.classList.add('light-mode');
          html.classList.remove('dark-mode');
          localStorage.setItem('theme', 'light');
          icon.classList.remove('fa-sun');
          icon.classList.add('fa-moon');
        }
        
        console.log('HTML classes after toggle:', html.className);
      });
      
      console.log('Theme toggle initialized successfully');
    } else {
      console.error('Theme toggle button not found!');
    }
  });
 </script>
 </head>
 <body>
 
 <a id="top"></a>
 
 <header class="site-header">
 	<div class="site-header-inner">
		<h1 class="weblog-title"><a href="{base-path}">{weblog-title}</a></h1>
 		<div class="site-nav">{navigation}</div>
		<button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark mode">
			<i class="fa-solid fa-moon"></i>
		</button>
 	</div>
 </header>
 
 <div class="site-layout">
 	<main class="content">
 		<article>
 			{body}
 			<div class="post-meta">
 				<p class="meta" style="margin: 0;">{date}</p>
 				<div class="post-tags">{tags}</div>
 			</div>
 		</article>
 
 		<hr>
 
 		<h2>Recent Posts</h2>
 		{recent-posts}
 	</main>
 
 	<aside class="sidebar">
 		<section class="module">
 			<h2>About</h2>
 			<p><strong>Brennan Kenneth Brown</strong></p>
 			<p>Essays, poetry, and musings on writing, technology, and the human experience.</p>
 			<p>→ <a href="https://brennanbrown.ca">More about me</a></p>
 		</section>

 		<section class="module">
 			<h2>Blogroll</h2>
 			<ul>
 				<li><a href="https://brennanbrown.ca">Main site</a></li>
 				<li><a href="https://berryhouse.ca">Berry House</a></li>
 				<li><a href="https://writeclub.ca">Write Club</a></li>
 				<li><a href="https://blog.brennanbrown.ca">Medium</a></li>
 				<li><a href="https://github.com/brennanbrown">GitHub</a></li>
 			</ul>
 		</section>

 		<section class="module">
 			<h2>Webrings</h2>
 			<p class="meta">Add your webring prev/next links here.</p>
 		</section>
 
 		<section class="module">
 			<h2>Support</h2>
 			<p>Enjoy this content? Help keep it going:</p>
 			<ul>
 				<li>[♥] <a href="https://patreon.com/brennankbrown">Patreon</a></li>
 			</ul>
 		</section>

 		<section class="module">
 			<h2>Site Stats</h2>
 			<p class="meta">Posts: {post-count}</p>
 		</section>

 		<section class="module">
 			<h2>Badges</h2>
 			<div class="badges-grid"></div>
 		</section>

 		<section class="module">
 			<h2>Elsewhere</h2>
 			<ul>
 				<li>[@] <a href="https://me.dm/@brennanbrown">Mastodon</a></li>
 				<li>[@] <a href="https://bsky.app/profile/brennanbrown.ca" rel="me atproto">Bluesky</a></li>
 				<li>[@] <a href="mailto:mail@brennanbrown.ca">Email</a></li>
 			</ul>
 		</section>
 	</aside>
 </div>
 
 <footer class="site-footer">
 	<div class="site-footer-inner">
		<p class="meta">Brennan Kenneth Brown</p>
		<p class="meta">Content licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.</p>
		<p class="footer-links">Links: <a href="/">Home</a> • <a href="/feed.xml">RSS</a> • <a href="/tags">Tags</a> • <a href="https://github.com/brennanbrown/omg.lol">Source</a> • <a href="/contact">Contact</a></p>
		<p class="meta">Made with <a href="https://weblog.lol">weblog.lol</a>.</p>
 	</div>
 </footer>
 
 <a class="to-top" href="#top">↑ TOP</a>
 
 </body>
 </html>
